# Проверка документов ЦСРМИ

Настольное Windows-приложение для автоматизации проверки лабораторных отчётов в формате Word (`.docx`) на корректность 11 ключевых реквизитов.

## Возможности

- ✅ Проверка Word документов на соответствие эталонным значениям
- ✅ Создание и управление шаблонами с 11 обязательными полями
- ✅ Поиск несоответствий (точные, опечатки, известные ошибки)
- ✅ Автоматическое исправление выбранных несоответствий
- ✅ Механизм обучения на новых ошибках
- ✅ Фильтрация результатов проверки
- ✅ Работа без установленного Microsoft Word (используется Open XML SDK)

## Требования

- Windows 11 (x64)
- .NET 8.0 Runtime

## Установка и запуск

### Сборка из исходников

1. Клонируйте репозиторий:
```bash
git clone https://github.com/avskvo-west94/avskvo-west94-doc_checker_csrmi_v2.git
cd avskvo-west94-doc_checker_csrmi_v2
```

2. Установите .NET 8.0 SDK (если еще не установлен):
   - Скачайте с [официального сайта Microsoft](https://dotnet.microsoft.com/download/dotnet/8.0)

3. Восстановите зависимости и соберите проект:
```bash
dotnet restore
dotnet build --configuration Release
```

4. Запустите приложение:
```bash
dotnet run --configuration Release
```

Или запустите собранный `.exe` файл из папки `bin/Release/net8.0-windows/`

## Использование

### 1. Создание шаблона

1. Откройте меню **Шаблоны** → **Управление шаблонами**
2. Нажмите **Создать**
3. Введите название шаблона и описание
4. Заполните эталонные значения для 11 обязательных полей:
   - Наименование изделия
   - Модель/модификация
   - Наименование производителя
   - Страна производителя
   - Наименование заявителя
   - Страна заявителя
   - Адрес производителя
   - Адрес заявителя
   - Наименование испытательной лаборатории
   - Регистрационный номер/код изделия
   - Дополнительное поле
5. При необходимости добавьте допустимые варианты для каждого поля
6. Сохраните шаблон

### 2. Проверка документа

1. Выберите шаблон через меню **Шаблоны** → **Выбрать шаблон**
2. Откройте документ через меню **Файл** → **Открыть документ**
3. Нажмите кнопку **Проверить документ**
4. Просмотрите результаты в таблице справа
5. Используйте фильтры для удобной навигации
6. Выберите несоответствия для исправления (чекбокс "Исправить")
7. Нажмите **Исправить выбранное**
8. Сохраните исправленный документ через **Файл** → **Сохранить исправленный документ как...**

### 3. Механизм обучения

Если программа не обнаружила ошибку, которую вы заметили:

1. Выберите меню **Обучение** → **Добавить ошибочный вариант**
2. Введите текст из документа
3. Выберите соответствующее поле
4. Сохраните

При следующих проверках программа автоматически будет распознавать такие варианты как ошибки.

## Структура проекта

```
DocumentChecker/
├── Models/              # Модели данных
│   ├── Template.cs      # Шаблон с эталонными значениями
│   ├── Field.cs         # Поле шаблона
│   ├── Discrepancy.cs   # Несоответствие
│   └── FieldDefinition.cs # Определения стандартных полей
├── Services/            # Бизнес-логика
│   ├── TemplateService.cs        # Работа с шаблонами (JSON)
│   ├── DocumentCheckerService.cs # Проверка документов
│   ├── DocumentFixService.cs     # Исправление документов
│   ├── TextNormalizer.cs         # Нормализация текста
│   └── FuzzyMatcher.cs           # Нечеткое сравнение строк
├── Views/               # Окна приложения
│   ├── TemplateManagementWindow.xaml
│   ├── TemplateSelectionWindow.xaml
│   ├── TemplateEditWindow.xaml
│   ├── VariantsWindow.xaml
│   └── LearningWindow.xaml
├── MainWindow.xaml      # Главное окно
└── App.xaml             # Точка входа приложения
```

## Хранение данных

Шаблоны сохраняются в JSON-файле по пути:
```
%APPDATA%\DocumentChecker\templates.json
```

## Технологии

- **.NET 8.0** - платформа разработки
- **WPF** - пользовательский интерфейс
- **DocumentFormat.OpenXml** - работа с Word документами
- **System.Text.Json** - сериализация шаблонов

## Лицензия

Проект создан для внутреннего использования.

## Автор

Разработано согласно ТЗ "Проверка документов ЦСРМИ"
