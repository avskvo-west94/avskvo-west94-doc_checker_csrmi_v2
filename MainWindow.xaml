<Window x:Class="DocumentChecker.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:DocumentChecker.Converters"
        Title="Проверка документов ЦСРМИ" Height="800" Width="1400"
        WindowStartupLocation="CenterScreen">
    <Window.Resources>
        <converters:DiscrepancyTypeConverter x:Key="DiscrepancyTypeConverter"/>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Меню -->
        <Menu Grid.Row="0">
            <MenuItem Header="Файл">
                <MenuItem Header="Открыть документ" Click="OpenDocument_Click"/>
                <MenuItem Header="Сохранить исправленный документ как..." Click="SaveDocumentAs_Click"/>
                <Separator/>
                <MenuItem Header="Выход" Click="Exit_Click"/>
            </MenuItem>
            <MenuItem Header="Шаблоны">
                <MenuItem Header="Выбрать шаблон" Click="SelectTemplate_Click"/>
                <MenuItem Header="Управление шаблонами" Click="ManageTemplates_Click"/>
            </MenuItem>
            <MenuItem Header="Обучение">
                <MenuItem Header="Добавить ошибочный вариант" Click="AddErrorVariant_Click"/>
            </MenuItem>
        </Menu>

        <!-- Основная область -->
        <Grid Grid.Row="1" Margin="5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="350"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Левая панель -->
            <Border Grid.Column="0" BorderBrush="Gray" BorderThickness="1" Padding="10">
                <StackPanel>
                    <TextBlock Text="Шаблон:" FontWeight="Bold" Margin="0,0,0,5"/>
                    <TextBlock x:Name="SelectedTemplateText" Text="Не выбран" Margin="0,0,0,10"/>
                    <Button Content="Выбрать шаблон" Click="SelectTemplate_Click" Margin="0,0,0,20"/>

                    <TextBlock Text="Эталонные значения:" FontWeight="Bold" Margin="0,10,0,5"/>
                    <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="400">
                        <ItemsControl x:Name="FieldsList">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border BorderBrush="LightGray" BorderThickness="1" Margin="0,5" Padding="5">
                                        <StackPanel>
                                            <TextBlock Text="{Binding Name}" FontWeight="Bold" FontSize="10"/>
                                            <TextBlock Text="{Binding ReferenceValue}" TextWrapping="Wrap" FontSize="9" 
                                                       Foreground="DarkGray" Margin="0,2,0,0"/>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>

                    <Button Content="Проверить документ" Click="CheckDocument_Click" 
                            Margin="0,20,0,0" Padding="10,5" FontSize="14" FontWeight="Bold"/>
                </StackPanel>
            </Border>

            <GridSplitter Grid.Column="1" HorizontalAlignment="Stretch" Background="Gray"/>

            <!-- Правая панель - Результаты проверки -->
            <Border Grid.Column="2" BorderBrush="Gray" BorderThickness="1" Padding="10">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="Результаты проверки:" FontWeight="Bold" FontSize="16" Margin="0,0,0,10"/>

                    <!-- Фильтры -->
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Фильтр по полю:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <ComboBox x:Name="FieldFilterComboBox" Width="200" SelectionChanged="FieldFilter_Changed"/>
                        <TextBlock Text="Тип:" VerticalAlignment="Center" Margin="20,0,5,0"/>
                        <ComboBox x:Name="TypeFilterComboBox" Width="150" SelectionChanged="TypeFilter_Changed">
                            <ComboBoxItem Content="Все"/>
                            <ComboBoxItem Content="Точное несовпадение"/>
                            <ComboBoxItem Content="Опечатка"/>
                            <ComboBoxItem Content="Известная ошибка"/>
                        </ComboBox>
                    </StackPanel>

                    <!-- Таблица результатов -->
                    <DataGrid x:Name="ResultsDataGrid" Grid.Row="2" 
                              AutoGenerateColumns="False" 
                              CanUserAddRows="False"
                              SelectionMode="Single"
                              GridLinesVisibility="All"
                              HeadersVisibility="Column">
                        <DataGrid.Columns>
                            <DataGridCheckBoxColumn Header="Исправить" Binding="{Binding ShouldFix}" Width="80"/>
                            <DataGridTextColumn Header="Поле" Binding="{Binding FieldName}" Width="200" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Ожидаемое значение" Binding="{Binding ExpectedValue}" Width="200" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Найденный текст" Binding="{Binding FoundText}" Width="250" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Тип" Binding="{Binding Type, Converter={StaticResource DiscrepancyTypeConverter}}" Width="150" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Местоположение" Binding="{Binding Location}" Width="200" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Контекст" Binding="{Binding Context}" Width="300" IsReadOnly="True"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Кнопки действий -->
                    <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                        <Button Content="Выделить все" Click="SelectAll_Click" Margin="0,0,5,0" Padding="10,5"/>
                        <Button Content="Снять выделение" Click="DeselectAll_Click" Margin="0,0,5,0" Padding="10,5"/>
                        <Button Content="Исправить выбранное" Click="FixSelected_Click" Padding="10,5" 
                                FontWeight="Bold" Background="LightGreen"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>
